<?xml version="1.0" encoding="UTF-8"?>
<!--
     ========================LICENSE_START=================================
      
     Copyright (C) 2025 Regione Piemonte
      
     SPDX-FileCopyrightText: (C) Copyright 2025  Regione Piemonte
     SPDX-License-Identifier: EUPL-1.2
     =========================LICENSE_END==================================
 -->

<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
       http://www.springframework.org/schema/aop
       http://www.springframework.org/schema/aop/spring-aop.xsd
       http://www.springframework.org/schema/util 
       http://www.springframework.org/schema/util/spring-util.xsd">


    <!-- helper per la gestione dei token e la connessione verso l'api manager -->
    <bean id="oauthHelper"
        class="it.csi.lgspa.lgspaweb.util.oauth2.OauthHelper">
        <constructor-arg index="0"
            value="XXXXX"></constructor-arg>
        <constructor-arg index="1"
            value="XXXXX"></constructor-arg>
        <constructor-arg index="2"
            value="XXXXX"></constructor-arg>
    </bean>

    <!-- factory del wrapper oauth per resteasy, con funzione di retry -->
    <bean id="petClientFactory"
        class="it.csi.lgspa.lgspaweb.util.oauth2.ResteasyOauthWrapperFactory">
        <property name="endPoint"
            value="XXXXX"></property>
        <property name="oauthHelper" ref="oauthHelper"></property>
        <property name="wrappedInterface"
            value="it.csi.lgspa.lgspaweb.integration.petstore.PetApi"></property>
    </bean>

    <!-- client dell'api PetStore da utilizzare nella logica di business, istanziato
        tramite factory, implementa l'interfaccia JAX-RS dell'API -->
    <bean id="petClient"
        class="it.csi.lgspa.lgspaweb.integration.petstore.PetApi"
        factory-bean="petClientFactory" factory-method="create"></bean>

</beans>